### select文

- 基本は`select 列1, 列2, ... from Table名;`
- 全ての列を取得したい場合は*で指定

よくあるミス
- DBを洗濯していない
- スペルミス（DB名、テーブル名、カラム名）
- 全角文字で入力する

書き方の補足
- 空白をいくつ足しても実行可能
- 改行しても良い
- みやすさのために改行とインデントを使うことがある
- 構文を大文字にして、テーブル名やカラム名は小文字にすることもある

### 比較演算子
https://www.dbonline.jp/mysql/ini/index7.html

### 集約関数
- sum(expr): 合計値
- avg(expr): 平均値
- min(expr): 最小値
- max(expr): 最大値
- count(expr): 行数

上記を利用したデータ集計の例
- 月別売り上げ
- 商品価格の最大値、最小値、平均値
- テーブル行数の取得
- 月別アクセス数
- 月別ユニークユーザー数
- 月別ユニークユーザー数がn人以上の月を抽出
- 都道府県別のユーザー数

### 集約関数におけるnullの扱い
- null: 値がないことを示す
- 集約関数ではnullが無視される
- DBにnullが含まれないように数値:0や文字列:''で代替できないか検討してみる

### SQLの記述順序
1. select       : 取得列の指定
2. from         : 対象テーブルの指定
3. where        : 絞り込み条件の指定
4. group by     : グループ化の条件指定
5. having       : グループ化後の絞り込みの条件指定
6. order by     : 並び替え条件を指定
7. limit        : 取得行数の制限

### SQLの実行順序
1. from         : 対象テーブルの指定
2. where        : 絞り込み条件の指定
3. group by     : グループ化の条件指定
4. having       : グループ化後の絞り込みの条件指定
5. select       : 取得列の指定
6. order by     : 並び替え条件を指定
7. limit        : 取得行数の制限


### 並び替え
- order by: ascは昇順（小->大）、descは降順（大->小）
- 並び順を指定しないと将来的にどんな順番で表示されるかわからない
- 複数条件で並び替えしたい時はorder byに併記
- 商品名で並び替えたい時、アルファベットならアルファベット順になる
- 日本語の場合は文字コード順になる

### 算術演算子
https://www.dbonline.jp/mysql/ini/index6.html

- nullを含んだ計算の結果はnullになる


### テーブルの結合


## ビュ- 
- テーブルは実際のデータを保存するが、ビューにはselect文は保存されておりデータは持たない
- 正し制限があり、order by句が使えない
- またパフォーマンス低下することがある

### ビューの作成と利用、及び削除

作成
```
create view ビュー名（列名1 ,列名2,...）as select文
```

利用
```
select
    列名1,
    列名2,
    ...
from
    ビュー名
```

削除
```
drop view ビュー名;
```

## サブクエリ
参考：https://qiita.com/aki3061/items/6df0513ccc5aa40a075a

サブクエリとは大雑把には、ある問合せに基づいて、異なる問合せを行う仕組みをさす。
これを使うことによって複雑な処理が行える。例として以下にあげる。

- 全商品の平均単価より、高い商品を取得
- 商品別の平均販売数量よりも多く売れている日を取得
- 商品カテゴリごとに平均単価を取得

### 構文
```
select
    列名, ...
from
    テーブル名
where
    列名 演算子（select 列名, ... from テーブル名2）
```